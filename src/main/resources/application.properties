# Application Configuration
quarkus.application.name=portfolio-api
quarkus.http.port=${PORT:8080}
quarkus.http.cors=true
quarkus.http.cors.origins=${FRONTEND_URL:http://localhost:3000}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=Content-Disposition
quarkus.http.cors.access-control-max-age=24H
quarkus.http.cors.access-control-allow-credentials=true
quarkus.http.auth.proactive=false

# REST API Configuration
quarkus.rest.path=/api

# Database Configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USERNAME:portfolio_user}
quarkus.datasource.password=${DB_PASSWORD:portfolio_password}
quarkus.datasource.jdbc.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:portfolio}
quarkus.datasource.jdbc.max-size=16

# Disable DevServices - use external database
quarkus.datasource.devservices.enabled=false
quarkus.devservices.enabled=false

# Hibernate Configuration
quarkus.hibernate-orm.database.generation=${DB_GENERATION:drop-and-create}
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.sql-load-script=no-file

# Database startup configuration
quarkus.datasource.health.enabled=false
quarkus.hibernate-orm.validate-in-dev-mode=false

# AWS Configuration
aws.region=${AWS_REGION:eu-west-3}
aws.credentials.access-key-id=${AWS_ACCESS_KEY_ID:}
aws.credentials.secret-access-key=${AWS_SECRET_ACCESS_KEY:}

# Custom AWS Properties
aws.s3.bucket-name=${AWS_S3_BUCKET_NAME:my-portfolio-media}
aws.cognito.user-pool-id=${AWS_COGNITO_USER_POOL_ID:}
aws.cognito.client-id=${AWS_COGNITO_CLIENT_ID:}
aws.cognito.region=${AWS_REGION:eu-west-3}

# JWT Configuration
mp.jwt.verify.publickey.location=${AWS_COGNITO_JWKS_URL:}
mp.jwt.verify.issuer=${AWS_COGNITO_ISSUER:}
smallrye.jwt.sign.key.location=privateKey.pem

# OpenAPI / Swagger Configuration
quarkus.smallrye-openapi.path=/openapi
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/docs
mp.openapi.extensions.smallrye.info.title=Portfolio API
mp.openapi.extensions.smallrye.info.version=1.0.0
mp.openapi.extensions.smallrye.info.description=RESTful API for managing a developer portfolio with internationalization support and admin interface
mp.openapi.extensions.smallrye.info.contact.name=Robin Dijoux
mp.openapi.extensions.smallrye.info.contact.email=dr@ecomail.fr

# Health Check
quarkus.smallrye-health.root-path=/api/health

# Logging
quarkus.log.level=INFO
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.category."com.portfolio".level=DEBUG

# File Upload Configuration
quarkus.http.body.multipart.file-content-types=image/jpeg,image/png,image/gif,video/mp4,application/pdf
quarkus.http.limits.max-body-size=100M

# Dev Mode Configuration
quarkus.test.continuous-testing=disabled
quarkus.test.display-test-output=true
quarkus.console.enabled=false
quarkus.live-reload.password=changeit

# Native Build Configuration
# Fix for SecureRandom issues with AWS SDK, Apache HTTP Client and UUID
quarkus.native.additional-build-args=\
  --initialize-at-run-time=software.amazon.awssdk.crt.CRT,\
  --initialize-at-run-time=software.amazon.awssdk.crt.CrtRuntimeException,\
  --initialize-at-run-time=software.amazon.awssdk.crt.io.ExponentialBackoffRetryOptions,\
  --initialize-at-run-time=software.amazon.awssdk.auth.credentials.internal.ContainerCredentialsProvider,\
  --initialize-at-run-time=software.amazon.awssdk.auth.credentials.internal.Ec2MetadataConfigProvider,\
  --initialize-at-run-time=java.security.SecureRandom,\
  --initialize-at-run-time=org.apache.http.impl.auth.NTLMEngineImpl,\
  --initialize-at-run-time=org.apache.http.impl.auth.NTLMEngine

# Enable Quarkus AWS SDK extensions for better native support
quarkus.native.enable-http-url-handler=true
quarkus.native.enable-https-url-handler=true
